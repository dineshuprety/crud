/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.3.6
 *
 */
!function(E){E.fn.extend({slimScroll:function(H){var S=E.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},H);return this.each(function(){var o,e,s,i,a,r,l,n,c,h="<div></div>",u=30,p=!1,d=E(this);if(d.parent().hasClass(S.wrapperClass)){var g,f=d.scrollTop(),b=d.closest("."+S.barClass),v=d.closest("."+S.railClass);if(y(),E.isPlainObject(H)){if("height"in H&&"auto"==H.height&&(d.parent().css("height","auto"),d.css("height","auto"),g=d.parent().parent().height(),d.parent().css("height",g),d.css("height",g)),"scrollTo"in H)f=parseInt(S.scrollTo);else if("scrollBy"in H)f+=parseInt(S.scrollBy);else if("destroy"in H)return b.remove(),v.remove(),void d.unwrap();m(f,!1,!0)}}else E.isPlainObject(H)&&"destroy"in H||(S.height="auto"==S.height?d.parent().height():S.height,f=E(h).addClass(S.wrapperClass).css({position:"relative",overflow:"hidden",width:S.width,height:S.height}),d.css({overflow:"hidden",width:S.width,height:S.height}),v=E(h).addClass(S.railClass).css({width:S.size,height:"100%",position:"absolute",top:0,display:S.alwaysVisible&&S.railVisible?"block":"none","border-radius":S.railBorderRadius,background:S.railColor,opacity:S.railOpacity,zIndex:90}),b=E(h).addClass(S.barClass).css({background:S.color,width:S.size,position:"absolute",top:0,opacity:S.opacity,display:S.alwaysVisible?"block":"none","border-radius":S.borderRadius,BorderRadius:S.borderRadius,MozBorderRadius:S.borderRadius,WebkitBorderRadius:S.borderRadius,zIndex:99}),h="right"==S.position?{right:S.distance}:{left:S.distance},v.css(h),b.css(h),d.wrap(f),d.parent().append(b),d.parent().append(v),S.railDraggable&&b.bind("mousedown",function(e){var i=E(document);return s=!0,t=parseFloat(b.css("top")),pageY=e.pageY,i.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,b.css("top",currTop),m(0,b.position().top,!1)}),i.bind("mouseup.slimscroll",function(e){s=!1,C(),i.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(e){return e.stopPropagation(),e.preventDefault(),!1}),v.hover(function(){x()},function(){C()}),b.hover(function(){e=!0},function(){e=!1}),d.hover(function(){o=!0,x(),C()},function(){o=!1,C()}),d.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(a=e.originalEvent.touches[0].pageY)}),d.bind("touchmove",function(e){p||e.originalEvent.preventDefault(),e.originalEvent.touches.length&&(m((a-e.originalEvent.touches[0].pageY)/S.touchScrollStep,!0),a=e.originalEvent.touches[0].pageY)}),y(),"bottom"===S.start?(b.css({top:d.outerHeight()-b.outerHeight()}),m(0,!0)):"top"!==S.start&&(m(E(S.start).position().top,null,!0),S.alwaysVisible||b.hide()),c=this,window.addEventListener?(c.addEventListener("DOMMouseScroll",w,!1),c.addEventListener("mousewheel",w,!1)):document.attachEvent("onmousewheel",w));function w(e){var t,i;o&&(t=0,(e=e||window.event).wheelDelta&&(t=-e.wheelDelta/120),e.detail&&(t=e.detail/3),i=e.target||e.srcTarget||e.srcElement,E(i).closest("."+S.wrapperClass).is(d.parent())&&m(t,!0),e.preventDefault&&!p&&e.preventDefault(),p||(e.returnValue=!1))}function m(e,t,i){p=!1;var o=e,s=d.outerHeight()-b.outerHeight();t&&(o=parseInt(b.css("top"))+e*parseInt(S.wheelStep)/100*b.outerHeight(),o=Math.min(Math.max(o,0),s),o=0<e?Math.ceil(o):Math.floor(o),b.css({top:o+"px"})),o=(l=parseInt(b.css("top"))/(d.outerHeight()-b.outerHeight()))*(d[0].scrollHeight-d.outerHeight()),i&&(e=(o=e)/d[0].scrollHeight*d.outerHeight(),e=Math.min(Math.max(e,0),s),b.css({top:e+"px"})),d.scrollTop(o),d.trigger("slimscrolling",~~o),x(),C()}function y(){r=Math.max(d.outerHeight()/d[0].scrollHeight*d.outerHeight(),u),b.css({height:r+"px"});var e=r==d.outerHeight()?"none":"block";b.css({display:e})}function x(){var e;y(),clearTimeout(i),l==~~l?(p=S.allowPageScroll,n!=l&&(e=0==~~l?"top":"bottom",d.trigger("slimscroll",e))):p=!1,n=l,r>=d.outerHeight()?p=!0:(b.stop(!0,!0).fadeIn("fast"),S.railVisible&&v.stop(!0,!0).fadeIn("fast"))}function C(){S.alwaysVisible||(i=setTimeout(function(){S.disableFadeOut&&o||e||s||(b.fadeOut("slow"),v.fadeOut("slow"))},1e3))}}),this}}),E.fn.extend({slimscroll:E.fn.slimScroll})}(jQuery);